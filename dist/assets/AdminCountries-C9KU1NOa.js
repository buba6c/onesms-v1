import{a as L,r as b,u as q,d as P,g as h,az as T,E as B,ax as f,j as e,B as S,L as g,R as E,k as N,t as v,h as I,I as K}from"./index-CJNHpMcx.js";import{u as D}from"./useMutation-DRoKD9_q.js";import{B as V}from"./badge-CTKbiBw2.js";import{t as Q,c as _,d as R,b as $}from"./sync-service-BsGjC2XL.js";import{b as z,c as G}from"./logo-service-D-UU2wJF.js";import{P as C}from"./plus-BhivJFUF.js";function ee(){const{t}=L(),[l,j]=b.useState(""),[r,A]=b.useState("all"),{toast:c}=q(),o=P(),{data:m=[],isLoading:M}=h({queryKey:["admin-countries",l,r],queryFn:()=>R({search:l||void 0,active:r==="all"?void 0:r==="active"})}),{data:a}=h({queryKey:["latest-sync"],queryFn:$,refetchInterval:5e3}),n=D({mutationFn:Q,onSuccess:s=>{var i;c({title:"Synchronisation réussie",description:`${((i=s.stats)==null?void 0:i.countries)||0} pays synchronisés`}),o.invalidateQueries({queryKey:["admin-countries"]}),o.invalidateQueries({queryKey:["latest-sync"]})},onError:s=>{c({title:"Erreur de synchronisation",description:s.message,variant:"destructive"})}}),k=D({mutationFn:({id:s,updates:i})=>_(s,i),onSuccess:()=>{o.invalidateQueries({queryKey:["admin-countries"]}),c({title:"Pays mis à jour"})}}),O=s=>{k.mutate({id:s.id,updates:{active:!s.active}})},u=m.length,d=m.filter(s=>s.active).length,U=m.length>0?(m.reduce((s,i)=>s+Number(i.price_multiplier||1),0)/m.length).toFixed(2):"1.00",y=m.filter(s=>Number(s.price_multiplier||1)>=1.3).length,w=[{label:t("admin.stats.totalCountries"),value:u,icon:T},{label:t("admin.active"),value:d,icon:B},{label:t("admin.inactive"),value:u-d,icon:f},{label:t("admin.stats.avgMultiplier"),value:`x${U}`,icon:C},{label:"Premium (≥1.3x)",value:y,icon:C}];return e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV("h1",{className:"text-3xl font-bold",children:t("admin.countries")},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:94,columnNumber:11},this),e.jsxDEV("p",{className:"text-gray-500",children:[d," ",t("admin.active").toLowerCase()," / ",u," ",t("admin.countries").toLowerCase()]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:95,columnNumber:11},this),a&&e.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:[t("admin.lastSync"),": ",new Date(a.started_at).toLocaleString()," - ",a.status]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:99,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:93,columnNumber:9},this),e.jsxDEV("div",{className:"flex gap-2",children:e.jsxDEV(S,{variant:"default",className:"bg-purple-600 hover:bg-purple-700",onClick:()=>n.mutate(),disabled:n.isPending||(a==null?void 0:a.status)==="running",children:[n.isPending||(a==null?void 0:a.status)==="running"?e.jsxDEV(g,{className:"w-4 h-4 mr-2 animate-spin"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:112,columnNumber:15},this):e.jsxDEV(E,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:114,columnNumber:15},this),"Sync avec 5sim"]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:105,columnNumber:11},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:104,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:92,columnNumber:7},this),e.jsxDEV(N,{children:e.jsxDEV(v,{className:"p-4",children:e.jsxDEV("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxDEV("div",{className:"flex-1 relative",children:[e.jsxDEV(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:126,columnNumber:15},this),e.jsxDEV(K,{placeholder:"Rechercher par nom ou code...",value:l,onChange:s=>j(s.target.value),className:"pl-10"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:127,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:125,columnNumber:13},this),e.jsxDEV("select",{value:r,onChange:s=>A(s.target.value),className:"px-4 py-2 border rounded-lg",children:[e.jsxDEV("option",{value:"all",children:"Tous les statuts"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:139,columnNumber:15},this),e.jsxDEV("option",{value:"active",children:"Actif"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:140,columnNumber:15},this),e.jsxDEV("option",{value:"inactive",children:"Inactif"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:141,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:134,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:124,columnNumber:11},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:123,columnNumber:9},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:122,columnNumber:7},this),e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:w.map((s,i)=>e.jsxDEV(N,{children:e.jsxDEV(v,{className:"p-6",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-sm text-gray-500",children:s.label},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:154,columnNumber:19},this),e.jsxDEV("h3",{className:"text-2xl font-bold mt-1",children:s.value},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:155,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:153,columnNumber:17},this),e.jsxDEV(s.icon,{className:"w-6 h-6 text-blue-500"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:157,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:152,columnNumber:15},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:151,columnNumber:13},this)},i,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:150,columnNumber:11},this))},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:148,columnNumber:7},this),e.jsxDEV(N,{children:M?e.jsxDEV("div",{className:"p-12 text-center",children:[e.jsxDEV(g,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:168,columnNumber:13},this),e.jsxDEV("p",{className:"text-gray-500",children:"Chargement des pays..."},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:169,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:167,columnNumber:11},this):m.length===0?e.jsxDEV("div",{className:"p-12 text-center",children:[e.jsxDEV("p",{className:"text-gray-500 mb-4",children:"Aucun pays trouvé"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:173,columnNumber:13},this),e.jsxDEV(S,{onClick:()=>n.mutate(),className:"bg-purple-600",children:[e.jsxDEV(E,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:175,columnNumber:15},this),"Sync avec 5sim"]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:174,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:172,columnNumber:11},this):e.jsxDEV("div",{className:"overflow-x-auto",children:e.jsxDEV("table",{className:"w-full",children:[e.jsxDEV("thead",{className:"bg-gray-50 border-b",children:e.jsxDEV("tr",{children:[e.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Pays"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:184,columnNumber:19},this),e.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:185,columnNumber:19},this),e.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Multiplicateur"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:186,columnNumber:19},this),e.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Disponible"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:187,columnNumber:19},this),e.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Provider"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:188,columnNumber:19},this),e.jsxDEV("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:189,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:183,columnNumber:17},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:182,columnNumber:15},this),e.jsxDEV("tbody",{className:"divide-y",children:m.map(s=>{var i;return e.jsxDEV("tr",{className:"hover:bg-gray-50",children:[e.jsxDEV("td",{className:"px-6 py-4",children:e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV("div",{className:"w-12 h-8 rounded border border-gray-200 overflow-hidden bg-white flex items-center justify-center",children:[e.jsxDEV("img",{src:z(s.code),alt:s.name,className:"w-full h-full object-cover",onError:F=>{const p=F.target;p.style.display="none";const x=p.nextElementSibling;x&&(x.style.display="flex")}},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:198,columnNumber:27},this),e.jsxDEV("span",{className:"text-2xl hidden items-center justify-center",children:G(s.code)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:210,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:197,columnNumber:25},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"font-medium",children:s.name},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:213,columnNumber:27},this),e.jsxDEV("div",{className:"text-xs text-gray-500",children:s.code},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:214,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:212,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:196,columnNumber:23},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:195,columnNumber:21},this),e.jsxDEV("td",{className:"px-6 py-4",children:e.jsxDEV(V,{variant:s.active?"success":"destructive",children:s.active?"Actif":"Inactif"},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:219,columnNumber:23},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:218,columnNumber:21},this),e.jsxDEV("td",{className:"px-6 py-4",children:e.jsxDEV("span",{className:"font-medium",children:["x",Number(s.price_multiplier||1).toFixed(2)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:224,columnNumber:23},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:223,columnNumber:21},this),e.jsxDEV("td",{className:"px-6 py-4",children:e.jsxDEV("span",{className:"text-green-600 font-medium",children:((i=s.available_numbers)==null?void 0:i.toLocaleString())||0},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:227,columnNumber:23},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:226,columnNumber:21},this),e.jsxDEV("td",{className:"px-6 py-4",children:e.jsxDEV(V,{className:"bg-blue-600",children:s.provider},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:232,columnNumber:23},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:231,columnNumber:21},this),e.jsxDEV("td",{className:"px-6 py-4",children:e.jsxDEV("div",{className:"flex gap-2",children:e.jsxDEV("button",{onClick:()=>O(s),className:"p-1 hover:bg-gray-100 rounded",title:"Toggle Active",children:e.jsxDEV(f,{className:`w-4 h-4 ${s.active?"text-orange-500":"text-green-500"}`},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:241,columnNumber:27},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:236,columnNumber:25},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:235,columnNumber:23},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:234,columnNumber:21},this)]},s.id,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:194,columnNumber:19},this)})},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:192,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:181,columnNumber:13},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:180,columnNumber:11},this)},void 0,!1,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:165,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/mac/Desktop/ONE SMS V1/src/pages/admin/AdminCountries.tsx",lineNumber:90,columnNumber:5},this)}export{ee as default};
